# 灵力系统设计文档

## 一、系统概述
灵力系统是游戏中的核心资源系统之一，用于驱动法术释放、法宝使用等核心玩法。本系统采用可配置化设计，支持动态调整数值参数。

## 二、核心设计

### 2.1 四维模型
灵力系统包含四个核心维度：
1. **基础值**：每个境界的基础灵力值，默认100
2. **恢复值**：不同场景下的灵力恢复速率
3. **最大值**：每个境界的最大灵力上限，每升一级增加100
4. **消耗值**：法术和法宝使用的灵力消耗

### 2.2 境界配置
灵力最大值按小境界划分，每升一层增加100点灵力：

| 大境界 | 小境界范围 | 灵力最大值范围 |
|--------|------------|----------------|
| 凡人 | - | 0 |
| 炼气期 | 一层~十层 | 100~1000 |
| 筑基期 | 一层~十层 | 1100~2000 |
| 金丹期 | 一层~十层 | 2100~3000 |
| 元婴期 | 一层~十层 | 3100~4000 |
| 化神期 | 一层~十层 | 4100~5000 |

**示例：**
- 炼气期一层：100
- 炼气期二层：200
- ...
- 炼气期十层：1000
- 筑基期一层：1100
- 筑基期二层：1200
- ...
- 化神期十层：5000

### 2.3 恢复机制
- **打坐恢复**：1秒恢复1点灵力
- **自然恢复**：每分钟恢复5点灵力

### 2.4 消耗机制
- **基础法术消耗**：20点灵力
- **基础法宝消耗**：30点灵力
- **等级乘数**：每提升一级，消耗增加10%

## 三、配置文件
配置文件路径：`server/config/spirit_system.json`

## 四、API接口
1. `GET /api/player/attributes` - 获取玩家当前灵力状态
2. `POST /api/player/meditate` - 打坐恢复灵力
3. `POST /api/player/cast-spell` - 释放法术消耗灵力
4. `POST /api/player/use-treasure` - 使用法宝消耗灵力

## 五、使用示例
```javascript
// 计算灵力消耗
const cost = attributeMaxService.calculateSpiritConsumption(3, 'spell');
// 结果：20 * 1.1^2 = 24
```